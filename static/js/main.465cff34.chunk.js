(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(7),l=a.n(o),c=a(5),s=(a(17),a(2));var i=e=>{let{onLogin:t}=e;const[a,o]=Object(r.useState)(""),[l,c]=Object(r.useState)(""),[s,i]=Object(r.useState)(""),[d,u]=Object(r.useState)(""),[p,m]=Object(r.useState)(!1),[g,h]=Object(r.useState)("");return n.a.createElement("div",null,n.a.createElement("h1",null,p?"Sign Up":"Login"," to Wings Cafe Inventory System"),p?n.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("http://localhost:5000/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:d})});if(!e.ok){const t=await e.json();throw new Error(t.message||"Error during sign-up.")}alert("Sign-up successful! You can now log in."),m(!1)}catch(t){h("Error during sign-up: "+t.message),console.error(t)}}},n.a.createElement("input",{type:"text",value:s,onChange:e=>i(e.target.value),placeholder:"New Username",required:!0}),n.a.createElement("br",null),n.a.createElement("input",{type:"password",value:d,onChange:e=>u(e.target.value),placeholder:"New Password",required:!0}),n.a.createElement("br",null),n.a.createElement("button",{type:"submit"},"Sign Up"),n.a.createElement("p",{className:"error"},g)):n.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("http://localhost:5000/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:l})});if(!e.ok){const t=await e.json();throw new Error(t.message||"Login failed.")}const n=await e.json();localStorage.setItem("loggedIn","true"),"function"===typeof t?t(n):console.error("onLogin is not a function")}catch(r){h("Invalid username or password."),console.error(r)}}},n.a.createElement("input",{type:"text",value:a,onChange:e=>o(e.target.value),placeholder:"Username",required:!0}),n.a.createElement("br",null),n.a.createElement("input",{type:"password",value:l,onChange:e=>c(e.target.value),placeholder:"Password",required:!0}),n.a.createElement("br",null),n.a.createElement("button",{type:"submit"},"Login"),n.a.createElement("p",{className:"error"},g)),n.a.createElement("button",{onClick:()=>m(!p)},p?"Already a user? Log in here":"New user? Sign Up here"))};var d=()=>{const[e,t]=Object(r.useState)([]),[a,o]=Object(r.useState)({name:"",category:"",price:"",quantity:""}),[l,c]=Object(r.useState)(null),[s,i]=Object(r.useState)(""),[d,u]=Object(r.useState)("");Object(r.useEffect)(()=>{p()},[]);const p=async()=>{try{const a=await fetch("http://localhost:5000/api/product");if(!a.ok)throw new Error("Failed to fetch products");const r=await a.json();t(r),localStorage.setItem("products",JSON.stringify(r))}catch(e){console.error("Fetch products error:",e),u("Error fetching products. Loading cached data.");const a=localStorage.getItem("products");a&&t(JSON.parse(a))}},m=async(e,t)=>{const a=parseInt(s,10);if(isNaN(a)||a<=0)alert("Please enter a valid quantity to add or deduct.");else try{if(!(await fetch(`http://localhost:5000/api/products/${e}/quantity`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({changeType:t,quantityChange:a})})).ok)throw new Error("Failed to update quantity");p(),i("")}catch(r){console.error("Quantity change error:",r),u("Error updating quantity")}},g=()=>{o({name:"",category:"",price:"",quantity:""}),c(null),u("")};return n.a.createElement("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto"}},n.a.createElement("h2",{style:{textAlign:"center",marginBottom:"20px"}},l?"Edit Product":"Add New Product"),d&&n.a.createElement("p",{style:{color:"red"}},d),n.a.createElement("input",{value:a.name,onChange:e=>o({...a,name:e.target.value}),placeholder:"Product Name",style:{padding:"8px",margin:"10px 0",width:"100%",borderRadius:"4px"}}),n.a.createElement("input",{value:a.category,onChange:e=>o({...a,category:e.target.value}),placeholder:"Category",style:{padding:"8px",margin:"10px 0",width:"100%",borderRadius:"4px"}}),n.a.createElement("input",{value:a.price,onChange:e=>o({...a,price:e.target.value}),placeholder:"Price",type:"number",style:{padding:"8px",margin:"10px 0",width:"100%",borderRadius:"4px"}}),n.a.createElement("input",{value:a.quantity,onChange:e=>o({...a,quantity:e.target.value}),placeholder:"Quantity",type:"number",style:{padding:"8px",margin:"10px 0",width:"100%",borderRadius:"4px"}}),n.a.createElement("button",{onClick:async()=>{const e={...a,price:parseFloat(a.price)||0,quantity:parseInt(a.quantity,10)||0};try{let a;if(!(a=l?await fetch(`http://localhost:5000/api/product/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}):await fetch("http://localhost:5000/api/product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Failed to save product");p(),g()}catch(t){console.error("Save product error:",t),u("Error saving product")}},style:{padding:"10px 20px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px"}},l?"Update Product":"Add Product"),n.a.createElement("h3",{style:{marginTop:"30px"}},"Product List"),n.a.createElement("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"20px"}},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Name"),n.a.createElement("th",null,"Category"),n.a.createElement("th",null,"Price"),n.a.createElement("th",null,"Quantity"),n.a.createElement("th",null,"Actions"))),n.a.createElement("tbody",null,e.map(t=>n.a.createElement("tr",{key:t.name},n.a.createElement("td",null,t.name),n.a.createElement("td",null,t.category),n.a.createElement("td",null,t.price),n.a.createElement("td",null,t.quantity),n.a.createElement("td",null,n.a.createElement("button",{onClick:()=>(t=>{const a=e.find(e=>e.name===t);o({name:a.name,category:a.category,price:a.price,quantity:a.quantity}),c(t)})(t.name),style:{padding:"5px 10px",backgroundColor:"#f0ad4e",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Edit"),n.a.createElement("button",{onClick:()=>(async e=>{try{if(!(await fetch(`http://localhost:5000/api/product/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete product");p()}catch(t){console.error("Delete product error:",t),u("Error deleting product")}})(t.name),style:{padding:"5px 10px",backgroundColor:"#d9534f",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Delete"),n.a.createElement("button",{onClick:()=>m(t.name,"add"),style:{padding:"5px 10px",backgroundColor:"#5bc0de",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Add Quantity"),n.a.createElement("button",{onClick:()=>m(t.name,"deduct"),style:{padding:"5px 10px",backgroundColor:"#f0ad4e",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Deduct Quantity"),n.a.createElement("input",{type:"number",value:s,onChange:e=>i(e.target.value),placeholder:"Enter qty",style:{padding:"5px",margin:"5px 0",width:"80%",borderRadius:"4px"}})))))))},u=a(8);a(18);var p=e=>{let{activeUser:t}=e;const[a,o]=Object(r.useState)([]),[l,c]=Object(r.useState)(0),[s,i]=Object(r.useState)([]),[d,p]=Object(r.useState)(0),m=["/Mahali/images/biscuits.jpeg","/Mahali/images/image2.jpg","/Mahali/images/image3.jpg"];Object(r.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("products"))||[];o(e);const t=e.reduce((e,t)=>e+t.quantity,0);c(t);const a=e.filter(e=>e.quantity<5);i(a)},[]),Object(r.useEffect)(()=>{const e=setInterval(()=>{p(e=>(e+1)%m.length)},3e3);return()=>clearInterval(e)},[m.length]);const g={labels:a.map(e=>e.name),datasets:[{label:"Quantity in Stock",data:a.map(e=>e.quantity),backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]};return n.a.createElement("div",{style:{padding:"20px",backgroundColor:"#f4f4f4",borderRadius:"8px",maxWidth:"800px",margin:"0 auto"}},n.a.createElement("h1",{style:{color:"#333",fontSize:"24px",textAlign:"center"}},"Welcome to Wings Cafe Inventory Management, ",t),n.a.createElement("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"}},n.a.createElement("h2",{style:{color:"#333",fontSize:"20px"}},"Stock Summary"),n.a.createElement("p",null,"Total Products: ",a.length),n.a.createElement("p",null,"Total Stock Quantity: ",l),n.a.createElement("p",null,"Low Stock Products:"),n.a.createElement("ul",null,s.map((e,t)=>n.a.createElement("li",{key:t,style:{color:"red"}},e.name," - Only ",e.quantity," left")))),n.a.createElement("div",{style:{marginTop:"30px",padding:"15px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"}},n.a.createElement("h2",{style:{color:"#333",fontSize:"20px",textAlign:"center"}},"Stock Quantity Chart"),n.a.createElement(u.a,{data:g,options:{responsive:!0,plugins:{legend:{display:!1},tooltip:{enabled:!0,callbacks:{label:e=>`Quantity: ${e.raw}`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Quantity"}},x:{title:{display:!0,text:"Product Name"}}}}})),n.a.createElement("div",{style:{marginTop:"30px",padding:"15px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)",textAlign:"center"}},n.a.createElement("h2",{style:{color:"#333",fontSize:"20px"}},"Product Images"),n.a.createElement("img",{src:m[d],alt:`Product ${d+1}`,style:{width:"200px",height:"auto",margin:"0 auto"}})))};var m=function(){const[e,t]=Object(r.useState)([]),[a,o]=Object(r.useState)(""),[l,c]=Object(r.useState)(""),[s,i]=Object(r.useState)(null),[d,u]=Object(r.useState)(null);Object(r.useEffect)(()=>{p()},[]);const p=()=>{fetch("http://localhost:5000/api/users").then(e=>{if(!e.ok)throw new Error(`Error fetching users. Status: ${e.status}`);const t=e.headers.get("content-type");if(t&&t.includes("application/json"))return e.json();throw new Error("Expected JSON, but received a non-JSON response")}).then(e=>t(e)).catch(e=>{console.error("Error fetching users:",e),u(e.message.includes("404")?"User API endpoint not found.":`Error fetching users: ${e.message}`),t([])})},m=()=>{o(""),c(""),i(null)},g={marginBottom:"10px",padding:"8px",width:"100%",boxSizing:"border-box",borderRadius:"4px",border:"1px solid #ccc"},h={backgroundColor:"#007bff",color:"white",padding:"10px 20px",border:"none",borderRadius:"4px",cursor:"pointer",width:"100%",marginTop:"10px"},y={backgroundColor:"#ffffff",padding:"15px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",marginBottom:"10px"},b={textAlign:"center",color:"#333"},E={display:"flex",justifyContent:"center",gap:"10px",marginTop:"10px"};return n.a.createElement("div",{style:{padding:"20px",backgroundColor:"#f4f4f4",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",width:"800px",margin:"auto"}},n.a.createElement("h2",{style:b},"User Management"),d&&n.a.createElement("p",{style:{color:"red",textAlign:"center"}},d),n.a.createElement("input",{value:a,onChange:e=>o(e.target.value),placeholder:"Username",style:g}),n.a.createElement("input",{value:l,onChange:e=>c(e.target.value),placeholder:"Password",style:g}),n.a.createElement("button",{onClick:()=>{const t={username:a,password:l};if(null!==s){const t=e[s].id;fetch(`http://localhost:5000/api/users/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:l})}).then(e=>{if(!e.ok)return e.json().then(e=>{u(e.message||"Error updating user")});p()}).catch(e=>console.error("Error updating user:",e))}else fetch("http://localhost:5000/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{if(!e.ok)return e.json().then(e=>{u(e.message||"Error adding user")});p()}).catch(e=>console.error("Error adding user:",e));m()},style:h},null!==s?"Update":"Add"," User"),n.a.createElement("h3",{style:b},"User List"),0===e.length?n.a.createElement("p",{style:{textAlign:"center"}},"No users available."):n.a.createElement("ul",{style:{listStyleType:"none",paddingLeft:"0"}},e.map((t,a)=>n.a.createElement("li",{key:a,style:y},n.a.createElement("h4",null,t.username),n.a.createElement("div",{style:E},n.a.createElement("button",{onClick:()=>(t=>{const a=e[t];o(a.username),c(a.password),i(t)})(a),style:{...h,backgroundColor:"#007bff",width:"auto"}},"Edit"),n.a.createElement("button",{onClick:()=>(t=>{const a=e[t].id;fetch(`http://localhost:5000/api/users/${a}`,{method:"DELETE"}).then(p).catch(e=>console.error("Error deleting user:",e))})(a),style:{...h,backgroundColor:"#e74c3c",width:"auto"}},"Delete"))))))};const g={display:"flex",justifyContent:"center",gap:"15px",marginBottom:"20px",backgroundColor:"#f4f4f4",padding:"10px 0"},h={backgroundColor:"#4CAF50",color:"white",padding:"10px 20px",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px",transition:"background-color 0.3s"};var y=function(){const[e,t]=Object(r.useState)([]),[a,o]=Object(r.useState)([]),[l,c]=Object(r.useState)(null),[u,y]=Object(r.useState)(!1),[b,E]=Object(r.useState)(null),f=Object(s.p)(),x=async(e,t)=>{try{y(!0);const r=await fetch(e);if(!r.ok)throw new Error(`Failed to fetch ${e}. Status: ${r.status}`);const n=r.headers.get("content-type");if(n&&n.includes("application/json"))t(await r.json());else{const e=await r.text();E(`Expected JSON but got HTML content: ${e.substring(0,200)}`),console.error("Received HTML content:",e)}}catch(a){console.error(`Error fetching ${e}:`,a),E(`Error fetching data from ${e}: ${a.message}`)}finally{y(!1)}};return Object(r.useEffect)(()=>{x("/api/users",t),x("/api/product",o)},[]),Object(r.useEffect)(()=>{l?localStorage.setItem("activeUser",JSON.stringify(l)):localStorage.removeItem("activeUser")},[l]),n.a.createElement("div",{className:"App"},b&&n.a.createElement("p",{style:{color:"red"}},b),l&&n.a.createElement("nav",{style:g},n.a.createElement("button",{onClick:()=>f("/dashboard"),style:h},"Dashboard"),n.a.createElement("button",{onClick:()=>f("/productManagement"),style:h},"Product Management"),n.a.createElement("button",{onClick:()=>f("/userManagement"),style:h},"User Management"),n.a.createElement("button",{id:"logoutButton",onClick:async function(){const e=localStorage.getItem("sessionToken");try{const a=await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionToken:e})}),r=await a.json();a.ok?(console.log("Logout successful:",r.message),localStorage.removeItem("sessionToken")):console.log("Logout failed:",r.message)}catch(t){console.error("Error during logout:",t)}}},"Logout"),"                "),u&&n.a.createElement("p",null,"Loading..."),n.a.createElement(s.d,null,n.a.createElement(s.b,{path:"/",element:l?n.a.createElement(s.a,{to:"/dashboard"}):n.a.createElement(i,{onLogin:c})}),n.a.createElement(s.b,{path:"/dashboard",element:l?n.a.createElement(p,{products:a}):n.a.createElement(s.a,{to:"/"})}),n.a.createElement(s.b,{path:"/productManagement",element:l?n.a.createElement(d,{setProducts:o,products:a}):n.a.createElement(s.a,{to:"/"})}),n.a.createElement(s.b,{path:"/userManagement",element:l?n.a.createElement(m,{users:e,setUsers:t}):n.a.createElement(s.a,{to:"/"})})))};var b=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,20)).then(t=>{let{getCLS:a,getFID:r,getFCP:n,getLCP:o,getTTFB:l}=t;a(e),r(e),n(e),o(e),l(e)})};l.a.createRoot(document.getElementById("root")).render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(c.a,null,n.a.createElement(y,null)))),b()},9:function(e,t,a){e.exports=a(19)}},[[9,1,2]]]);
//# sourceMappingURL=main.465cff34.chunk.js.map